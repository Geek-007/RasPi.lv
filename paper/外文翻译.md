# Raspberry Pi based Interactive Home Automation System through E-mail

摘要：家庭自动化正因为它的优点而变得越来越流行。家庭自动化可以通过局域网实现，也可以采用远程控制。本论文旨在设计一种基于树莓派的基础家庭自动化应用，能够通过电子邮件主题来控制。该系统将采用树莓派所采用的默认Python环境开发运行相应的算法。结果表明了本次实现家庭自动化的算法是非常有效的。与此同时，LED灯被用于指示开关行为。

关键字：树莓派，电子邮件，家庭自动化，Python

一、简介

家庭自动化是指应用计算机和信息技术来控制家用电器和家居环境。它的应用从简单到复杂的计算机远程控制照明或者以微控制器为基础的网络，涉及不同程度的智能化和自动化的变化。家庭自动化带来了方便，节能，安全效益，从而提高生活质量。

近年来由于网络功能的简化和更高的承受能力，网络的普及使家庭自动化已大大增加。此外，随着互联网的迅速扩张，存在对这样的功能的网络设备的远程控制和监控的潜力。然而，新的令人兴奋的机会也来了，通过互联网连接家居设备和家庭自动化的实现，这方面还有待探索。

这里有几个有关“家庭自动化”定义的文献。Bromley等在2003年描述了家庭自动化，“将技术引进家庭，通过如提供远程医疗，多媒体娱乐和节能等不同的服务，将提高它的居住者的生活质量”。在家庭自动化领域，有许多其他方面的通信协议的显著研究，如蓝牙，手势，DTMF等。从作者的审查认定，XIO行业标准是最早的一种标准，于1975年所开发的电子设备通信标准，通过家中的电源线为家用设备提供有限的控制。Sriskanthan等人在2002年提出了一个基于蓝牙技术的家庭自动化系统，包括一个主控制器和多个蓝牙控制器。

Al-Ali等在2004年开发了一个基于Java的家庭自动化系统。通过使用内置的网络安全功能的Java技术，实现了一种安全的解决方案。然而，该系统需要非常烦杂的的布线设计，而且必须使用高端电脑，这使得成本非常昂贵。Baudel等人在1993年提出了一种新的使用手势的控制网络，该控制器采用手套来使系统识别手势。Ardam等人在1998年提出了基于电话的远程控制器，用于家庭和办公自动化。系统的不同之处在于，所有的通信发生在一个固定的电话线，而不在互联网上。该系统可以使用任何支持双音多频（DTMF）电话访问。

关于家庭自动化的研究在公共领域主要是在学术领域，在公开的文献中几乎没有有关的工业研究。家庭自动化技术进入商业系统还比较有限，主要在于现有消费者的接受程度不够。上述系统提供的互操作方式很少。随着家庭网关的发展，可以尝试于网络互联和家庭自动化系统的远程访问。Kushirio等人在1998年提出了一个家庭能源集中管理的家庭网关，用于连接家庭网络与互联网。该系统安装在东京地区的二十个家庭。Saito等在2000年定义了一个家庭网关，作为一个个人区域网络和公共网络之间的访问入口点。Yoon等人在2008年实现了家庭网关接收手机信号，能够启动或关闭家庭设备，使用LED作为指示。Ok等人在2006年提出了一种基于OSGI（Open Service Gateway Initiative）的家庭网关，它允许服务提供商接入家庭自动化系统的管理和维护服务。这些系统都为家庭网关的发展做出了重大贡献。然而，在为各自的家庭网关选择网络整合的时候，现有家庭环境中的网络基础设施还没有被考虑。

本论文提出一种基于树莓派的使用电子邮件控制的家庭自动化系统的方案。

Raspberry Pi（见图1）是一个信用卡大小的单板计算机。由树莓派基金会开发，旨在刺激英国学校的计算机基础教学。它有两种模型；模型A有256MB内存，一个USB端口，没有网络连接。模型B有512MB内存，2个USB端口和一个以太网端口。它有一个博通BCM2835芯片系统，包括一个ARM1176JZF-S 700MHz处理器，第四代Video Core GPU，和一个SD卡槽。该GPU能够播放蓝光质量的视频，采用H.264 40MBits/s。它有一个快速的3D核心，可使用OpenGL ES2.0和OpenVG库。该芯片提供HDMI支持，而不支持VGA。

基金会提供了Debian和Arch Linux的ARM发行版，同时也将Python作为主要编程语言，支持BBC BASIC，C和Perl，图2中（树莓派用户指南）提供了树莓派板的详细描述。Python作为主要编程语言，因为大家普遍认为，它是一门既容易学习又完全成熟的编程语言，非常适用于现实世界中的应用。由于NumPy，SciPy，Matplotlib，IPython，和PyLab等库，Python可以用于数学计算以及对实验数据分析或系统控制（Ali等，于2013年）

同时，­Raspberry Pi迷你电脑最近在广大地区都非常流行，开启了巨大的计算潜力。由于树莓派系统的独特优势，该技术在发展中国家提供的解决方案有很大的前景。这将包括但不限于作为一种教育工具，尤其是使用GPIO（通用输入/输出）允许数据的自动采集和在学校实验室制作简单的数字控制系统。用于教育目的的时候，Raspberry Pi的最鲜明的特征就是GPIO模块，可以与通用的电子设备连接（Ali等，于2013年）。

本文介绍了Raspberry Pi的一种通过互联网（电子邮件）进行家庭自动化控制的基本应用程序，在接收相应的电子邮件的主题后，由已开发的算法送入Raspberry Pi后，系统对相应的指令进行响应。根据消费者的需求，该系统具有交互式的，高效的和灵活的特点。它立即回复消费者Raspberry Pi的工作状态。该系统实际使用发光二极管作为开关信号指标测试，可以直接看到结果。该项目可以扩展更多的应用，包括家庭设备的监控，开关电源监控，故障监测，功率控制，安全问题等等。

二、配置

图3描述了该系统的配置。由于用户友好的功能和经济效益，树莓派被选为系统的处理单元。此外，Python编码算法已被送入Raspberry Pi，­通过调制器解调器（MODEM）连接到互联网接口，用于访问和发送电子邮件给消费者。由于不同的器件和Raspberry Pi的额定功率不同，被控制的设备与Raspberry Pi之间采用继电器驱动电路连接。也可以连接显示器（可选），用于查看Raspberry Pi的即时处理状态。

三、控制算法

输入和输出的GPIO引脚被定义来控制不同的设备。Raspberry Pi板的GPIO引脚布局如图4所示。在26引脚，3引脚被用于控制本项目中的3个发光二极管，这是开关设备的测试信号。为了实用目的，继电器驱动电路和继电器可与Raspberry Pi和电器分别连接，分别实现控制。

本项目使用的引脚：Pin7（GPIO4），Pin11（GPIO17）和Pin12（GPIO18）。在搭载在Raspberry Pi上的Python环境中，编写实现家庭自动化控制策略的代码。首先，代码设置初始化，并且使用python集成开发环境中的电子邮件库登录到家庭G-Mail账户（G-Mail IMAP）。初始化成功后，Raspberry Pi开始根据代码中指定的帐户阅读电子邮件的主题。这些邮件的主题是从初始化命令接口设备和控制信号进行比较，根据它在相应的GPIO引脚产生的。这个过程不断重复间隔为0.5秒钟。图5以流程图的形式表示了所使用的编码算法。图6显示了在Python集成开发环境中编码的该算法的控制模块。在这里，从电子邮件读取的主题存储在一个数组x[]中，而“if”结构体定义了每个数组元素的操作，即如果主题是“ON1”，Raspberry Pi就会回复“打开开关1”给发送者，同时打开PIN.7引脚开关，结构回路每0.5秒会检查一遍新邮件。

四、性能评估

为了验证算法的实用性，LED作为指示接口设备的开关信号。实验装置如图7所示。结果通过一系列的电子邮件发送到Raspberry Pi的G-Mail账户，相应的收件箱和树莓派G-Mail账户分别在图8和图9中表示。例如，一份“ON1”主题的电子邮件从消费者账号（anant.vaib@gmail.com）被发送到树莓派账号（raspanantsarthak@gmail.com）。该算法中，获取主题中的“ON1”，然后打开装置1，由LED1指示。
并立即回复发件人一份电子邮件“打开开关1”，在主题之下：“家庭自动化已激活”。代码还包括在消费者发送无效的电子邮件的情况下的异常处理。

同样的开关可以通过给Raspberry Pi账户发送“OFF1”主题的电子邮件来关闭。此外，这项由两个开关控制的工作，可以通过发送带有'ON2'&'ON3'主题的电子邮件来打开开关2及开关3，相应地，'OFF2'&'OFF3"来关掉。因此，研究结果表明，家庭自动化已经成功实施，并且非常具有效率和可靠。

五、总结和展望

在这个高度发展的时代，在直接的或间接的情况下，一切都将依赖于计算机和信息技术，Raspberry Pi被证明是一个聪明、经济、高效的实现家庭自动化平台。本文提供了使用Raspberry Pi很容易地实现和使用有效的家庭自动化应用基础。所提供的代码也是通用、灵活的，使用一种用户友好的方式，可以很容易地为任何未来的应用进行扩展，如功率控制，监控等等。此外，该技术优于其他家庭自动化方法的几种方法。例如，通过DTMF实现家庭自动化，通话资费是一个巨大的劣势，这不是在这种情况下所提出的方法。同时，相比于基于Web服务器的家庭自动化，这种方法消除了Web服务器的设计和所需的空间，因为它只是利用了已经存在的Web服务器提供的Gmail电子邮件服务。